/*! bootstrap-ssdlg 2015-09-10 */
"use strict";!function(a){"function"==typeof define&&define.amd?define(["jquery","jquery-imagerect","bootstrap-colorpicker-plus","bootstrap-slider"],a):window.jQuery&&!window.jQuery.fn.shapeStyleDialog&&a(window.jQuery)}(function(a){var b=["Arial","Verdana","Helvetica","Courier","Times","Roboto","Oswald","Open Sans Condensed","Roboto Slab","Droid Serif","Roboto Condensed","Raleway","Bangers","Permanent Marker","Droid Sans Mono"],c=[9,10,11,12,13,14,16,18,20,24,36,48,64,72,96,110,127],d={strokeSize:1},e=function(e,f){var g=this;this.element=e;var h=a(e);this.opts=a.extend({},d,h.data(),f),this.colorpickerembeds=a(".colorpickerembed.colorpickerplus-container",h),this.colorpickerembeds.colorpickerembed(),this.colorpickerembeds.on("changeColor",a.proxy(this.onOptChanged,this)),this.colorpickerpluss=a("button[data-toggle=colorpickerplus]",h),this.colorpickerpluss.colorpickerplus(),this.colorpickerpluss.on("changeColor",a.proxy(this.onOptChanged,this)),this.sliders=a("input[data-toggle=slider]",h).slider(),this.sliders.on("slideStop",a.proxy(this.onOptChanged,this)),a("ul[aria-labelledby]",h).each(function(){var d=a(this).attr("aria-labelledby");switch(d){case"fontFamilyDropdownMenu":for(var e=0;e<b.length;e++)a('<li data-ssdlg-key="font-family" data-ssdlg-val="'+b[e]+'"><a href="#">'+b[e]+"</a></li>").appendTo(a(this));break;case"fontSizeDropdownMenu":for(e=0;e<c.length;e++)a('<li data-ssdlg-key="font-size" data-ssdlg-val="'+c[e]+'"><a href="#">'+c[e]+"px</a></li>").appendTo(a(this))}}),h.on("click","button[data-toggle=dropdown]",function(){var b=a(this),c=b.attr("id"),d=a("ul[aria-labelledby="+c+"]",a(e)),f=a("li",d);f.each(function(){var b=a(this).data("ssdlg-key"),c=a(this).data("ssdlg-val");return null!==b&&c===g.option[b]?!1:void 0})}),h.on("click","li[data-ssdlg-key],button[data-ssdlg-val],a[data-ssdlg-key]",function(){var b=a(this).data("ssdlg-key");if(null!=b){var c=a(this).data("ssdlg-val");switch(b){case"font-style":c="italic"===c?"normal":"italic",a(this).data("ssdlg-val",c);break;case"font-weight":c="bolder"===c?"normal":"bolder",a(this).data("ssdlg-val",c);break;case"font-decoration":c="underline"===c?"line-through":"line-through"===c?"overline":"overline"===c?"":"underline",a(this).data("ssdlg-val",c);break;default:0===b.indexOf("font-align-")&&(c=g.handleFontAlign(a(this),b.substring(11)),b="font-align")}g.changeOpt(b,c,a(this))}}),a("input[data-ssdlg-key]",h).on("blur",a.proxy(this.inputBlur,this));var i=a("#tab_image"),j=a(".imagerect",i).imagerect();j.on("load",a.proxy(this.imgload,this)),j.on("pick",a.proxy(this.imagepick,this)),this.imgpicker=j,a("input",i).on("blur",a.proxy(this.imagePickerBlur,this)),a('a[data-toggle="tab"]',h).on("show.bs.tab",function(b){a(b.target).addClass("active"),a(b.relatedTarget).removeClass("active")}),a('a[data-toggle="tab"]',h).on("shown.bs.tab",a.proxy(this.tabShown,this)),a(".slider",h).on("click touchstart",a.proxy(this.stopPropagation,this)),a("#ssdlg-link-btn").on("click",function(){a("#ssdlg-link-panel").toggle()}),a("#ssdlg-link-panel").toggle(),a(".dropdown-menu",h).parent().on("show.bs.dropdown",a.proxy(this.onDropdownShow,this))};e.version="0.1.0",e.prototype={constructor:e,setDlgItemStyle:function(b,c,d,e){var f=a(this.element);switch(b){case"fillStyle":var g=a(".shapestyle-dlg-background-icon",d.closest(".dropdown-colorpickerplus"));if(null!=c?(g.removeClass("colorpicker-color"),g.css("background-color",c)):(g.removeAttr("style"),g.addClass("colorpicker-color")),e){var h=this.colorpickerembeds.index('[data-ssdlg-key="fillStyle"]');this.colorpickerembeds.eq(h).colorpickerembed("update",c)}break;case"strokeStyle":var i=a(".shapestyle-dlg-line",f);null!=c?(i.removeClass("colorpicker-color"),i.css("background-color",c)):i.addClass("colorpicker-color"),e&&this.colorpickerembeds.eq(this.colorpickerembeds.index('[data-ssdlg-key="strokeStyle"]')).colorpickerembed("update",c);break;case"x":case"y":case"w":case"h":case"r":a('input[data-ssdlg-key="'+b+'"]',f).val(c);break;case"alpha":this.sliders.slider("setValue",c);break;default:if(0===b.indexOf("font-")){var j=a('button[data-ssdlg-key="'+b+'"]');j.data("ssdlg-val",c)}}},changeOpt:function(b,c,d){var e=a(this.element);this.opt(b,c,d),e.trigger("optionChange",[b,c])},onOptChanged:function(b){var c=a(this.element),d=a(b.target).data("ssdlg-key"),e=b.color||b.value,f=a(b.target);this.opts[d]=e,this.setDlgItemStyle(d,e,f,!1),c.trigger("optionChange",[d,e])},opt:function(a,b,c){this.opts[a]=b,this.setDlgItemStyle(a,b,c,!0)},setCPPColor:function(b,c){var d=a(this.element),e=a('button[data-toggle=colorpickerplus][data-ssdlg-key="'+b+'"]',d);e.data("cpp-color",c),this.opt(b,c,e)},option:function(b){var c=a(this.element);if(b){this.opts=a.extend({},d,c.data(),b);for(var e in b)switch(e){case"strokeStyle":this.setCPPColor(e,b[e]);break;case"fillStyle":this.opt(e,b[e],a('div[data-ssdlg-key="'+e+'"]',c));break;default:this.opt(e,b[e])}}return this.opts},handleFontAlign:function(a,b){var c="font-align",d=a.data("ssdlg-val");return a.data("ssdlg-val",d===b?0:b),d=d===b?this.opts[c]|b:this.opts[c]&~b},imgload:function(b){var c=a(this.element);c.trigger("imgLoaded",[b.relatedTarget]);var d=this.imgpicker.imagerect("rect");this.onImgRect(d)},imagepick:function(a){var b=a.value;this.onImgRect(b)},imgInput:function(){var a=this.imgPickerUrl.val();a?this.imgpicker.imagerect("option",{url:a}):this.imgPickerUrl.tooltip("show")},onImgRect:function(b){for(var c in b){var d="#formRectP"+c.toUpperCase();a(d).val(Math.round(b[c]*this.imgpicker.data("imagerect").percent*100)/100)}var e=this.imgpicker.imagerect("option");b.url=e.url,this.changeOpt("img",b)},imagePickerBlur:function(b){var c=a(b.target),d=c.val(),e=c.attr("id"),f=null;switch(a.isNumeric(d)&&(d/=this.imgpicker.data("imagerect").percent),e){case"formRectPX":f={x:d};break;case"formRectPY":f={y:d};break;case"formRectPW":f={w:d};break;case"formRectPH":f={h:d};break;case"imgPickerUrl":d?this.imgpicker.imagerect("option",{url:d}):c.tooltip("show")}if(f){f=this.imgpicker.imagerect("rect",f);var g=this.imgpicker.imagerect("option");this.changeOpt("img",a.extend({url:g.url},f))}},inputBlur:function(b){var c=a(b.target),d=c.val();c.is("[type=checkbox")&&(d=c.is(":checked"));var e=c.data("ssdlg-key");this.changeOpt(e,d)},stopPropagation:function(a){a.stopPropagation()},tabShown:function(b){var c=a(b.target).attr("href");"#tab_image"===c&&this.opts.img&&this.imgpickerUpdate()},imgpickerUpdate:function(){this.imgpicker.imagerect("rect",this.opts.img)},onDropdownShow:function(b){var c=this.opts.type;"line"===c||"linex"===c||"linexx"===c?a(".dropdown-arrows",a(b.target)).removeClass("disabled"):a(".dropdown-arrows",a(b.target)).addClass("disabled")}},a.shapeStyleDialog=e,a.fn.shapeStyleDialog=function(b){var c=arguments,d=null;return this.each(function(){var f=a(this),g=f.data("shapeStyleDialog"),h="object"==typeof b?b:{};g||"string"==typeof b?"string"==typeof b&&(d=g[b].apply(g,Array.prototype.slice.call(c,1))):f.data("shapeStyleDialog",new e(this,h))}),d||this},a.fn.shapeStyleDialog.constructor=e});