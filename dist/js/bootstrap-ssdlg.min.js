/*! bootstrap-ssdlg 2015-09-16 */
"use strict";!function(a){"function"==typeof define&&define.amd?define(["jquery","jquery-imagerect","bootstrap-colorpicker-plus","bootstrap-slider"],a):window.jQuery&&!window.jQuery.fn.shapeStyleDialog&&a(window.jQuery)}(function(a){var b=["Arial","Verdana","Helvetica","Courier","Times","Roboto","Oswald","Open Sans Condensed","Roboto Slab","Droid Serif","Roboto Condensed","Raleway","Bangers","Permanent Marker","Droid Sans Mono"],c=[9,10,11,12,13,14,16,18,20,24,36,48,64,72,96,110,127],d={strokeSize:1},e=function(e,f){var g=this;this.element=e;var h=a(e);this.opts=a.extend({},d,h.data(),f),a(".colorpickerembed.colorpickerplus-container",h).on("changeColor",a.proxy(this.onOptChanged,this)).colorpickerembed(),a("button[data-toggle=colorpickerplus]",h).on("changeColor",a.proxy(this.onOptChanged,this)).colorpickerplus(),a("input[data-toggle=slider]",h).on("slideStop",a.proxy(this.onOptChanged,this)).slider(),a("ul[aria-labelledby]",h).each(function(){var d=a(this).attr("aria-labelledby");switch(d){case"fontFamilyDropdownMenu":for(var e=0;e<b.length;e++)a('<li data-ssdlg-key="font-family" data-ssdlg-val="'+b[e]+'"><a href="#">'+b[e]+"</a></li>").appendTo(a(this));break;case"fontSizeDropdownMenu":for(e=0;e<c.length;e++)a('<li data-ssdlg-key="font-size" data-ssdlg-val="'+c[e]+'"><a href="#">'+c[e]+"px</a></li>").appendTo(a(this))}}),h.on("click","button[data-toggle=dropdown]",function(){var b=a(this),c=b.attr("id"),d=a("ul[aria-labelledby="+c+"]",a(e)),f=a("li",d);f.each(function(){var b=a(this).data("ssdlg-key"),c=a(this).data("ssdlg-val");return null!==b&&c===g.option[b]?!1:void 0})}),h.on("click","li[data-ssdlg-key],button[data-ssdlg-val],a[data-ssdlg-key]",function(){var b=a(this).data("ssdlg-key");if(null!=b){var c=a(this).data("ssdlg-val");switch(b){case"font-style":c="italic"===c?"normal":"italic",a(this).data("ssdlg-val",c);break;case"font-weight":c="bolder"===c?"normal":"bolder",a(this).data("ssdlg-val",c);break;case"font-decoration":c="underline"===c?"line-through":"line-through"===c?"overline":"overline"===c?"":"underline",a(this).data("ssdlg-val",c);break;default:0===b.indexOf("font-align-")&&(c=g.handleFontAlign(a(this),b.substring(11)),b="font-align")}g.changeOpt(b,c,a(this))}}),a("input[data-ssdlg-key]",h).on("blur",a.proxy(this.inputBlur,this));var i=a("#tab_image"),j=a(".imagerect",i).imagerect();j.on("loaded",a.proxy(this.onImgRect,this)),j.on("rect",a.proxy(this.onImgRect,this)),this.imgpicker=j.data("imagerect"),a("input",i).on("blur",a.proxy(this.imagePickerBlur,this)),a('a[data-toggle="tab"]',h).on("show.bs.tab",function(b){var c=a(b.target);c.parent().is(".disabled")?(b.preventDefault(),b.stopPropagation()):(c.addClass("active"),a(b.relatedTarget).removeClass("active"))}),a('a[data-toggle="tab"]',h).on("shown.bs.tab",a.proxy(this.tabShown,this)),a(".slider",h).on("click touchstart",a.proxy(this.stopPropagation,this)),a("#ssdlg-link-btn").on("click",function(){a("#ssdlg-link-panel").toggle()}),a("#ssdlg-link-panel").toggle(),a(".dropdown-menu",h).parent().on("show.bs.dropdown",a.proxy(this.onDropdownShow,this))};e.version="0.1.0",e.prototype={constructor:e,setDlgItemStyle:function(b,c,d){var e=a(this.element);switch(b){case"fillStyle":var f=a(".shapestyle-dlg-background-icon",d.closest(".dropdown-colorpickerplus"));null!=c?(f.removeClass("colorpicker-color"),f.css("background-color",c)):(f.removeAttr("style"),f.addClass("colorpicker-color"));break;case"strokeStyle":var g=a(".shapestyle-dlg-line",e);null!=c?(g.removeClass("colorpicker-color"),g.css("background-color",c)):g.addClass("colorpicker-color");break;case"x":case"y":case"w":case"h":case"r":a('input[data-ssdlg-key="'+b+'"]',e).val(c);break;case"alpha":break;default:if(0===b.indexOf("font-")){var h=a('button[data-ssdlg-key="'+b+'"]');h.data("ssdlg-val",c)}}},changeOpt:function(b,c,d){var e=a(this.element);this.opt(b,c,d),/\d+/.test(c)&&(c=parseInt(c)),e.trigger("optionChange",[b,c])},onOptChanged:function(b,c){var d=a(this.element),e=a(b.target).data("ssdlg-key"),f=b.value||c,g=a(b.target);this.opts[e]=f,this.setDlgItemStyle(e,f,g,!1),d.trigger("optionChange",[e,f])},opt:function(a,b,c){this.opts[a]=b,this.setDlgItemStyle(a,b,c)},setCPPColor:function(b,c){var d=a(this.element),e=a('button[data-toggle=colorpickerplus][data-ssdlg-key="'+b+'"]',d);e.data("cpp-color",c),this.opt(b,c,e)},option:function(b){var c=a(this.element);if(b){this.opts=a.extend({},d,c.data(),b);for(var e in b)switch(e){case"strokeStyle":this.setCPPColor(e,b[e]);break;case"fillStyle":this.opt(e,b[e],a('div[data-ssdlg-key="'+e+'"]',c));break;default:this.opt(e,b[e])}}return this.opts},handleFontAlign:function(a,b){var c="font-align",d=a.data("ssdlg-val");return a.data("ssdlg-val",d===b?0:b),d=d===b?this.opts[c]|b:this.opts[c]&~b},imgInput:function(){var a=this.imgPickerUrl.val();a?this.imgpicker.load(a):this.imgPickerUrl.tooltip("show")},onImgRect:function(b,c){for(var d in c){var e="#formRectP"+d.toUpperCase();a(e).val(Math.round(c[d]*this.imgpicker.percent*100)/100)}var f=this.imgpicker.opts;c.url=f.url,this.changeOpt("img",c)},imagePickerBlur:function(b){var c=a(b.target),d=c.val(),e=c.attr("id"),f=null;switch(a.isNumeric(d)&&(d/=this.imgpicker.percent),e){case"formRectPX":f={x:d};break;case"formRectPY":f={y:d};break;case"formRectPW":f={w:d};break;case"formRectPH":f={h:d};break;case"imgPickerUrl":d?this.imgpicker.load(d):c.tooltip("show")}if(f){f=this.imgpicker.rect(f);var g=this.imgpicker.opts;this.changeOpt("img",a.extend({url:g.url},f))}},inputBlur:function(b){var c=a(b.target),d=c.val();c.is("[type=checkbox")&&(d=c.is(":checked"));var e=c.data("ssdlg-key");this.changeOpt(e,d)},stopPropagation:function(a){a.stopPropagation()},tabShown:function(b){var c=a(b.target).attr("href");"#tab_image"===c&&this.opts.img&&this.imgpickerUpdate()},imgpickerUpdate:function(){this.imgpicker.load(this.opts.img.url,this.opts.img)},onDropdownShow:function(b){var c=this.opts.type,d=a(b.target);"line"===c||"linex"===c||"linexx"===c?a(".dropdown-arrows",d).removeClass("disabled"):a(".dropdown-arrows",d).addClass("disabled");var e=a(".colorpickerembed",d);e.length>0&&e.colorpickerembed("update",this.opts[e.data("ssdlg-key")]);var f=a("input[data-toggle=slider]",d);f.length>0&&f.slider("setValue",100*this.opts[f.data("ssdlg-key")])}},a.shapeStyleDialog=e,a.fn.shapeStyleDialog=function(b){var c=arguments,d=null;return this.each(function(){var f=a(this),g=f.data("shapeStyleDialog"),h="object"==typeof b?b:{};g||"string"==typeof b?"string"==typeof b&&(d=g[b].apply(g,Array.prototype.slice.call(c,1))):f.data("shapeStyleDialog",new e(this,h))}),d||this},a.fn.shapeStyleDialog.constructor=e});